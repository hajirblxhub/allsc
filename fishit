loadstring([[
    function LPH_NO_VIRTUALIZE(f) return f end;
]])();

local success, WindUI = pcall(function()
    return loadstring(game:HttpGet("https://raw.githubusercontent.com/Footagesus/WindUI/main/dist/main.lua"))()
end)

if not success or not WindUI then
    warn("‚ö†Ô∏è UI failed to load!")
    return
else
    print("‚úì UI loaded successfully!")
end


local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local isMobile = game:GetService("UserInputService").TouchEnabled

local net = ReplicatedStorage:WaitForChild("Packages", 10):WaitForChild("_Index", 10):WaitForChild("sleitnick_net@0.2.0", 10):WaitForChild("net", 10)
local remotes = net:GetChildren()

local function GetServerRemote(targetName)
    local allRemotes = net:GetChildren()
    for i, remote in ipairs(allRemotes) do
        if remote.Name == targetName then
            return allRemotes[i + 1]
        end
    end
    return nil
end

local function GetServerRemoteReverse(targetName)
    local allRemotes = net:GetChildren()
    for i, remote in ipairs(allRemotes) do
        if remote.Name == targetName then
            return allRemotes[i - 1]
        end
    end
    return nil
end

print("remotes length: " .. #remotes)

local Connections = {}
local Events = {}
local mutationTarget = {}
local Tasks = {}
local lastTimeFishCaught
local magix = -2

if #remotes ~= 323 then
    magix = 0
end

local Controllers
local NotificationController
local GiftingController
local TextNotificationController
local VFXController
local CutsceneController
local ControlModule
local FishingController
local AFKController
local PromptController
local BackpackController
local Replion
local PlayerData
local ItemUtility
local TierUtility

if isMobile then
    Controllers = ReplicatedStorage:WaitForChild("Controllers")
    NotificationController = require(Controllers:WaitForChild("NotificationController"))
    GiftingController = require(Controllers:WaitForChild("GiftingController"))
    TextNotificationController = require(Controllers:WaitForChild("TextNotificationController"))
    VFXController = require(Controllers:WaitForChild("VFXController"))
    FishingController = require(Controllers:WaitForChild("FishingController"))
    AFKController = require(Controllers:WaitForChild("AFKController"))
    PromptController = require(Controllers:WaitForChild("PromptController"))
    BackpackController = require(Controllers:WaitForChild("BackpackController"))
    CutsceneController = require(Controllers:WaitForChild("CutsceneController"))
    Replion = require(ReplicatedStorage.Packages.Replion)
    PlayerData = Replion.Client:WaitReplion("Data")
    ControlModule = require(LocalPlayer:WaitForChild("PlayerScripts"):WaitForChild("PlayerModule"):WaitForChild("ControlModule"))
    Promise = require(ReplicatedStorage:WaitForChild("Packages").Promise)
    ItemUtility = require(ReplicatedStorage.Shared.ItemUtility)
    TierUtility = require(ReplicatedStorage:WaitForChild("Shared"):WaitForChild("TierUtility"))
    print("mobile")
else
    print("üíª Player menggunakan PC / Laptop")
end

local needCast = true

local Config = {
    MainLoop = true,
    InstantFishing = false,
    AutoCatch = false,
    Perfection = false,
    isFarming = false,
    isMinig = false,
    AutoFarm = false,
    AutoFarmMegalodon = false,
    AutoFarmChristmas = false,
    AutoFavorite = false,
    CatchDelay = 0.7,
    CastDelay = 1.12,
    ChargeDelay = 0,
    CancelDelay = 0.78,
    DisableAnimations = false,
    PerfectionValue = 0.28,
    onlyMythicAndSecret = false,
    onlyRareAndEpic = false,
    onlySecret = false,
    autoWeather = false,
    removePopUp = false,
    antiFall = false,
    gpuSaver = false,
    customEffect = false,
    AutoSell = true,
    SellDelay = 15,
    SpeedHack = false,
    SpeedHackValue = 60,
    WalkOnWater = false,
    HookNotif = false,
    BackupPerfection = false,
    AutoTradeEvolveEnchant = false,
    AutoAcceptTrade = false,
    AutoSendTrade = false,
    FavRubyGemstone = false,
    isFreeze = false,
    backupIsFreeze = false,
    autoFishing = false,
    DisablePopUp = false,
    DisableVfx = false,
    DisableCutscene = false,
    CustomWebhook = false,
    WebhookUrl = "https://discord.com/api/webhooks/1461727812917526681/PY7QeWuw4dHp8NmurEcHiLMJIx06Akxwpna_wpWXA1QKayarcy4W73k25gtrpHQ77pq5",
    CustomWebhookUrl = "",
    HideUsn = false,
    AutoMining = false,
    axeUuid = "",
    autoConsumeCaveCrystal = false,
    savePosition = false,
    position = "",
    antiOKOK = false,
    SpinPlayer = false,
    UB = {
        Active = false,
        Settings = {
            CompleteDelay = 3.7,
            CancelDelay = 0.25
        },
        Remotes = {},
        Stats = {
            castCount = 0,
            startTime = 0
        }
    }
}

local needCast, skip = false, false

local ReplicatedStorage = game:GetService("ReplicatedStorage")

local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer

local IntervalWaktu = 60 * 18

for i, v in pairs(getconnections(LocalPlayer.Idled)) do
    if v.Disable then v:Disable() elseif v.Disconnect then v:Disconnect() end
end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "TalonBypass_Ghost"
ScreenGui.Parent = CoreGui

local MainFrame = Instance.new("Frame")
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(255, 0, 100)
MainFrame.BackgroundTransparency = 0.5
MainFrame.Position = UDim2.new(0.5, -206, 0.5, -35)
MainFrame.Size = UDim2.new(0, 80, 0, 30)
MainFrame.Active = true
MainFrame.Draggable = false

local UICorner = Instance.new("UICorner", MainFrame)
UICorner.CornerRadius = UDim.new(0, 8)

local Label = Instance.new("TextLabel")
Label.Parent = MainFrame
Label.Size = UDim2.new(1, 0, 1, 0)
Label.BackgroundTransparency = 1
Label.Text = "Talon Bypass ü§ç"
Label.TextColor3 = Color3.fromRGB(255, 255, 255)
Label.TextSize = 10
Label.Font = Enum.Font.GothamBold
Label.TextWrapped = true

local function FireUIAtLocation()
    local x = MainFrame.AbsolutePosition.X + (MainFrame.AbsoluteSize.X / 2)
    local y = MainFrame.AbsolutePosition.Y + (MainFrame.AbsoluteSize.Y / 2)
    
    local guiObjects = LocalPlayer.PlayerGui:GetGuiObjectsAtPosition(x, y)
    
    for _, obj in pairs(guiObjects) do
        if obj:IsA("GuiButton") then
            for _, connection in pairs(getconnections(obj.MouseButton1Click)) do
                connection:Fire()
            end
            for _, connection in pairs(getconnections(obj.Activated)) do
                connection:Fire()
            end
            
            obj.BackgroundTransparency = 0.8
            task.delay(0.1, function() obj.BackgroundTransparency = 0 end)
        end
    end
end

task.spawn(function()
    while true do
        task.wait(IntervalWaktu)
        FireUIAtLocation()
        print("Talon Bypass Triggered.")
    end
end)

RunService.Heartbeat:Connect(function()
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        LocalPlayer.Character.HumanoidRootPart.CFrame = LocalPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(0, 0.00001, 0)
    end
end)

local function safeFire(func)
    task.spawn(function()
        pcall(func)
    end)
end

local function safeCall(func)
    pcall(func)
end

local origDeliverNotification = isMobile and TextNotificationController.DeliverNotification

local function hookNotification()
    if isMobile then
        TextNotificationController.DeliverNotification = function(self, data, ...)
            if Config.autoFishing then
                print(tostring(data.Text))
                if string.find(tostring(data.Text), "stopped") then
                    print("stopped")
                    Events.UpdateAutoFishingState:InvokeServer(true)
                end
            end
            return origDeliverNotification(self, data, ...)
        end
    end
end

hookNotification()

Events.equip = GetServerRemote("RE/EquipToolFromHotbar")
Events.unequip = GetServerRemote("RE/UnequipToolFromHotbar")
Events.equipItem = GetServerRemote("RE/EquipItem")
Events.CancelFishingInputs = GetServerRemote("RF/CancelFishingInputs")

local function getAxeUUID()
    local inv = PlayerData:GetExpect("Inventory")
    local items = inv.Items
    print("ok item")
    for _, item in ipairs(items) do
        if item.Id == 20220 then
            Config.axeUuid = item.UUID
            print(Config.axeUuid)
        end
    end
end

local function pickAxe()
    getAxeUUID()
    print("pick axe")
    Events.CancelFishingInputs:InvokeServer()
    task.wait(0.7)
    Events.unequip:FireServer()
    print("pick axe unequip")
    task.wait(1)
    BackpackController.ToggleHotbarItem(self, Config.axeUuid)
    print(Config.axeUuid)
end

local isNoFallActive = false
local platform = nil

local function createPlatform(position)
    if platform then return end
    platform = Instance.new("Part")
    platform.Name = "AirPlatform"
    platform.Size = Vector3.new(7, 1, 7)
    platform.Anchored = true
    platform.CanCollide = true
    platform.Transparency = 0.9
    platform.Position = position - Vector3.new(0, 3, 0)
    platform.Parent = workspace
end

local function equipRod()
    Events.equip:FireServer(1)
    if Config.autoFishing or Config.AutoCatch then
        Events.UpdateAutoFishingState:InvokeServer(true)
    end
end

local blatantFishCycleCount = 0

local function ub_loop()
    while Config.UB.Active do
        if Config.isMinig then
            task.wait(3)
        else
            local currentTime = tick()
            safeFire(function()
                Config.UB.Remotes.CancelFishingInputs:InvokeServer()
            end)
            task.wait(needCast and 0.7 or Config.UB.Settings.CancelDelay)
            needCast = false
            safeFire(function()
                Config.UB.Remotes.equip:FireServer(1)
                Config.UB.Remotes.ChargeFishingRod:InvokeServer({ [1] = currentTime })
                if Config.antiOKOK then
                    local delay = math.random(15, 17) / 100
                    task.wait(delay)
                end
                Config.UB.Remotes.RequestMinigame:InvokeServer(1, 0, currentTime)
            end)
            task.wait(Config.UB.Settings.CompleteDelay)
            if not skip then
                safeFire(function()
                    Config.UB.Remotes.FishingCompleted:InvokeServer()
                end)
            end
            blatantFishCycleCount = blatantFishCycleCount + 1
        end
    end
end

function UB_init()
    local success, netFolder = pcall(function()
        return ReplicatedStorage:WaitForChild("Packages", 10)
            :WaitForChild("_Index", 10)
            :WaitForChild("sleitnick_net@0.2.0", 10)
            :WaitForChild("net", 10)
    end)
    if not success or not netFolder then
        warn("Gagal menemukan folder jaringan (net). Pastikan script berjalan di game yang benar.")
        return false
    end
    local remotes = netFolder:GetChildren()
    
    Config.UB.Remotes.ChargeFishingRod = GetServerRemote("RF/ChargeFishingRod")
    Config.UB.Remotes.RequestMinigame = GetServerRemote("RF/RequestFishingMinigameStarted")
    Config.UB.Remotes.CancelFishingInputs = GetServerRemote("RF/CancelFishingInputs")
    Config.UB.Remotes.UpdateAutoFishingState = GetServerRemote("RF/UpdateAutoFishingState")
    Config.UB.Remotes.FishingCompleted = GetServerRemote("RF/CatchFishCompleted")
    Config.UB.Remotes.MinigameChanged = GetServerRemote("RE/FishingMinigameChanged")
    Config.UB.Remotes.equip = GetServerRemote("RE/EquipToolFromHotbar")
    return true
end

function UB_start()
    if Config.UB.Active then
        print("UB sudah aktif.")
        return
    end
    if not UB_init() then
        print("Gagal menginisialisasi UB. Tidak bisa memulai.")
        return
    end
    Config.UB.Active = true
    needCast = true
    Config.UB.Stats.castCount = 0
    Config.UB.Stats.startTime = tick()
    Config.UB.Settings.CompleteDelay = Config.UB.Settings.CompleteDelay
    Config.UB.Settings.CancelDelay = Config.UB.Settings.CancelDelay
    Tasks.ubtask = task.spawn(ub_loop)
end

function UB_stop()
    if not Config.UB.Active then
        print("UB sudah tidak aktif.")
        return
    end
    Config.UB.Active = false
    safeFire(function()
        if Config.UB.Remotes.CancelFishingInputs then
            Config.UB.Remotes.CancelFishingInputs:InvokeServer()
        end
    end)
    safeFire(function()
        if Config.UB.Remotes.UpdateAutoFishingState then
            Config.UB.Remotes.UpdateAutoFishingState:InvokeServer(true)
        end
    end)
    task.wait(0.2)
    task.cancel(Tasks.ubtask)
    local runtime = tick() - Config.UB.Stats.startTime
    print("UB dihentikan. Waktu berjalan: " .. string.format("%.2f", runtime) .. " detik.")
end

local function onToggleUB(value)
    Config.HookNotif = true
    if value then
        equipRod()
        Config.UB.Settings.CompleteDelay = Config.UB.Settings.CompleteDelay
        Config.UB.Settings.CancelDelay = Config.UB.Settings.CancelDelay
        UB_start()
    else
        UB_stop()
        task.cancel(Tasks.ubtask)
    end
end

UB_init()

local targetRarities = {
    mythic = false,
    legendary = false,
    epic = false,
    rare = false,
    uncommon = false
}

local targetWebhookRarities = {
    mythic = false,
    legendary = false,
    epic = false,
    rare = false,
    uncommon = false
}

local CONFIG_FILE = "config.json"
local MUTATION_CONFIG = "mutation_config.json"
local RARITY_CONFIG = "rarity_config.json"
local RARITY_WH_CONFIG = "rarity_wh_config.json"

local function LoadConfig()
    task.spawn(function()
        if isfile(CONFIG_FILE) then
            local ok, data = pcall(function()
                return HttpService:JSONDecode(readfile(CONFIG_FILE))
            end)
            if ok and typeof(data) == "table" then
                for k, v in pairs(data) do
                    if Config[k] ~= nil then
                        Config[k] = v
                        print(k, v)
                    end
                end
            end
            print("xsuccess 1")
        end
    end)

    task.spawn(function()
        if isfile(MUTATION_CONFIG) then
            print("ada config mutasi")
            local ok, data = pcall(function()
                return HttpService:JSONDecode(readfile(MUTATION_CONFIG))
            end)
            if not ok then
                warn("JSONDecode error:", data)
                return false
            end
            if typeof(data) ~= "table" then
                warn("data bukan table:", typeof(data))
                return false
            end
            print("data type:", typeof(data))
            print("data length:", #data)
            table.clear(mutationTarget)
            for i, v in ipairs(data) do
                print("load mutation:", i, v, typeof(v))
                mutationTarget[i] = v
            end
            print("mutationTarget loaded:", #mutationTarget)
            return true
        end
    end)

    task.spawn(function()
        if isfile(RARITY_CONFIG) then
            local ok, data = pcall(function()
                return HttpService:JSONDecode(readfile(RARITY_CONFIG))
            end)
            if ok and typeof(data) == "table" then
                for k, v in pairs(data) do
                    if targetRarities[k] ~= nil then
                        targetRarities[k] = v
                    end
                end
            end
            print("xsuccess 3")
        end
    end)

    task.spawn(function()
        if isfile(RARITY_WH_CONFIG) then
            local ok, data = pcall(function()
                return HttpService:JSONDecode(readfile(RARITY_WH_CONFIG))
            end)
            if ok and typeof(data) == "table" then
                for k, v in pairs(data) do
                    if targetWebhookRarities[k] ~= nil then
                        targetWebhookRarities[k] = v
                    end
                end
            end
            print("xsuccess 4")
        end
    end)
end

local function SaveConfig(type)
    if type == 1 then
        writefile(CONFIG_FILE, HttpService:JSONEncode(Config))
    elseif type == 2 then
        writefile(MUTATION_CONFIG, HttpService:JSONEncode(mutationTarget))
    elseif type == 3 then
        writefile(RARITY_CONFIG, HttpService:JSONEncode(targetRarities))
    elseif type == 4 then
        writefile(RARITY_WH_CONFIG, HttpService:JSONEncode(targetWebhookRarities))
    end
end

local function SaveAllConfig()
    SaveConfig(1)
    SaveConfig(2)
    SaveConfig(3)
    SaveConfig(4)
end

LoadConfig()

Config.InstantFishing = false
Config.BlatantFishing = false
Config.AutoCatch = false
Config.UB.Active = false

Events.systemMessageEvent = GetServerRemote("RE/DisplaySystemMessage")
Events.fishNotif = GetServerRemote("RE/ObtainedNewFishNotification")

Events.systemMessageEvent.OnClientEvent:Connect(function(...)
    local args = {...}
    local character = LocalPlayer.Character
    if not character then return end
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    if not rootPart then return end
    if args[1] then args[1] = args[1]:lower() end
    
    if args[1] and (not string.find(args[1], "global") or string.find(args[1], "server")) and string.find(args[1], "staff") then
        game.Players.LocalPlayer:Kick("Awas ada sule, eh staff maksudnya")
    end
end)

local LOCATIONS = {
    ["Fisherman"] = CFrame.new(-18.065, 9.532, 2734.000, -0.113811, 0.000000, -0.993502, -0.000000, 1.000000, 0.000000, 0.993502, 0.000000, -0.113811),
    ["Sisyphus Statue"] = CFrame.new(-3754.441, -135.074, -895.376, 0.943844, 0, -0.330393, 0, 1, 0, 0.330393, 0, 0.943844),
    ["Coral Reefs"] = CFrame.new(-3030.043, 2.509, 2271.429, 0.304264, -0.000000, 0.952588, -0.000000, 1.000000, 0.000000, -0.952588, -0.000000, 0.304264),
    ["Esoteric Depths"] = CFrame.new(3271.979, -1301.530, 1402.762, -0.981542, -0.000000, -0.191249, -0.000000, 1.000000, 0.000000, 0.191249, 0.000000, -0.981542),
    ["Crater Island 1"] = CFrame.new(990.610, 21.142, 5060.255, 0.998865, 0.000000, -0.047632, -0.000000, 1.000000, -0.000000, 0.047632, 0.000000, 0.998865),
    ["Crater Island 2"] = CFrame.new(1040.036, 55.714, 5131.443, 0.551438, -0.000000, 0.834216, 0.000000, 1.000000, 0.000000, -0.834216, 0.000000, 0.551438),
    ["Lost Isle"] = CFrame.new(-3618.15698, 240.836655, -1317.45801),
    ["Weather Machine"] = CFrame.new(-1488.51196, 83.1732635, 1876.30298),
    ["Tropical Grove"] = CFrame.new(-2132.597, 53.488, 3631.235, -0.664326, -0.000000, 0.747443, -0.000000, 1.000000, 0.000000, -0.747443, -0.000000, -0.664326),
    ["Treasure Room"] = CFrame.new(-3630, -279.074, -1599.287, 0.721647, 0, -0.692261, 0, 1, 0, 0.692261, 0, 0.721647),
    ["Kohana"] = CFrame.new(-663.904236, 3.04580712, 718.796875),
    ["Kohana2"] = CFrame.new(-530.529, 8.750, -72.149, -0.910784, 0, -0.412883, 0, 1, 0, 0.412883, 0, -0.910784),
    ["Underground Cellar"] = CFrame.new(2110.109, -91.199, -699.790, 0.744219, -0.000000, -0.667935, -0.000000, 1.000000, -0.000000, 0.667935, 0.000000, 0.744219),
    ["Ancient Jungle"] = CFrame.new(1837.352, 5.894, -297.224, 0.388620, 0.000000, -0.921398, 0.000000, 1.000000, 0.000000, 0.921398, -0.000000, 0.388620),
    ["Ancient Jungle 2"] = CFrame.new(1468.971, 6.512, -326.397, -0.458676, 0.000000, -0.888603, 0.000000, 1.000000, 0.000000, 0.888603, -0.000000, -0.458676),
    ["Sacred Temple"] = CFrame.new(1459.217, -22.375, -637.787, 0.924266, 0, 0.381750, 0, 1, 0, -0.381750, 0, 0.924266),
    ["Ancient Ruins"] = CFrame.new(6097.176, -585.924, 4644.443, -0.514758, 0, 0.857336, 0, 1, 0, -0.857336, 0, -0.514758),
    ["Megalodon"] = CFrame.new(-1172.987, 7.924, 3620.589, 0.706693, 0, 0.707521, 0, 1, 0, -0.707521, 0, 0.706693),
    ["Pirate Cove"] = CFrame.new(3396.730, 4.192, 3469.213) * CFrame.Angles(-0.000, -1.447, -0.000),
    ["Pirate Treasure Room"] = CFrame.new(3324.07397, -306.475647, 3087.99927, 0.999340534, -1.78439805e-08, 0.0363113917, 2.01013268e-08, 1, -6.18013019e-08, -0.0363113917, 6.24904501e-08, 0.999340534),
    ["Secret Passage"] = CFrame.new(3436.101, -289.845, 3382.640, -0.920254, 0.000000, -0.391321, 0.000000, 1.000000, 0.000000, 0.391321, -0.000000, -0.920254),
    ["Kohana Volcano"] = CFrame.new(-549.192, 20.019, 125.802, 0.955081, 0.000000, -0.296344, -0.000000, 1.000000, 0.000000, 0.296344, -0.000000, 0.955081),
    ["Crystal Depth"] = CFrame.new(5752.219, -907.148, 15343.468, -0.628654, 0.000000, 0.777685, -0.000000, 1.000000, -0.000000, -0.777685, -0.000000, -0.628654),
    ["Lava Basin"] = CFrame.new(950.876, 85.282, -10199.427, 0.105691, -0.000000, 0.994399, -0.000000, 1.000000, 0.000000, -0.994399, -0.000000, 0.105691),
    ["Hearthfelt Island"] = CFrame.new(1116.154419, 4.863108, 2721.664551, -0.094682, 0.000000, -0.995508, 0.000000, 1.000000, 0.000000, 0.995508, -0.000000, -0.094682),
    ["Hearthfelt Cave"] = CFrame.new(1319.075562, -53.523628, 2748.127197, -0.850393, 0.000000, 0.526148, -0.000000, 1.000000, -0.000000, -0.526148, -0.000000, -0.85039)
}

local function teleport(cf)
    local char = LocalPlayer.Character
    if not char then return end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end
    hrp.CFrame = cf + Vector3.new(0, 3, 0)
end

local function teleportToMegalodon()
    for _, obj in ipairs(workspace:GetDescendants()) do
        if string.find(obj.Name:lower(), "megalodon") then
            task.wait(0.1)
            if obj:IsA("BasePart") then
                teleport(CFrame.new(obj.Position))
                startNoFall()
                atMegalodon = true
                Config.isFarming = true
                local rootpart = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                oldLocation = rootpart.CFrame
                return
            end
        end
    end
end

local function teleportTo(locationName)
    local cframe = LOCATIONS[locationName]
    local character = LocalPlayer.Character
    if not character then return end
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    if not rootPart then return end

    if string.find(locationName, "Megalodon") then
        teleportToMegalodon()
    else
        rootPart.CFrame = cframe
        if string.find(locationName, "Ruins") or string.find(locationName, "Christmas") then
            createPlatform(rootPart.Position)
        end
    end

    currentFishingLocation = cframe
end

getAxeUUID()
pickAxe()

local function isExtractPrompt(prompt)
    if not prompt.Enabled then return false end
    if not prompt.ActionText then return false end
    if not prompt.ActionText:lower():find("extract") then return false end

    local parent = prompt.Parent
    if not parent then return false end
    if not parent.Name:lower():find("crystal") then return false end

    return true
end

local function fixPrimaryPart(model)
    if model:IsA("Model") and not model.PrimaryPart then
        local part = model:FindFirstChildWhichIsA("BasePart")
        if part then
            model.PrimaryPart = part
        end
    end
end

local TELEPORT_OFFSET = -4

local function getHrp()
    local character = LocalPlayer.Character
    local hrp = character:FindFirstChild("HumanoidRootPart")
    return hrp
end

local function moveToPrompt(prompt)
    local hrp = getHrp()
    local target = prompt.Parent

    if target:IsA("Model") then
        fixPrimaryPart(target)
        target = target.PrimaryPart
    end

    if target and target:IsA("BasePart") then
        hrp.CFrame = target.CFrame * CFrame.new(0, 0, TELEPORT_OFFSET)
        createPlatform(hrp.Position)
    end
end

local function miningCrystal()
    teleportTo("Crystal Depth")
    task.wait(2)
    print("tp to cd")
    task.wait(1.5)
    for _, prompt in ipairs(workspace:GetDescendants()) do
        if prompt:IsA("ProximityPrompt") and isExtractPrompt(prompt) then
            moveToPrompt(prompt)
            task.wait(11)
            fireproximityprompt(prompt)
            task.wait(0.5)
        end
    end
end

local function setMining()
    Events.CancelFishingInputs:InvokeServer()
    task.wait(0.7)
    Events.unequip:FireServer()
    task.wait(1)
    pickAxe()
    task.wait(2)
    Config.isFarming = true
    miningCrystal()
end

Events.TextNotification = GetServerRemote("RE/TextNotification")
Events.TextNotification.OnClientEvent:Connect(function(...)
    local args = {...}
    if args[1].Text then
        print("TextNotification text: " .. args[1].Text)
    end
    if args[1].Text and string.find(args[1].Text, "find them") and Config.AutoMining then
        print("waktunya nambang")
        getAxeUUID()
        local rootPart = getRootPart()
        if not rootPart then return end
        local origLocation = rootPart.CFrame
        savedPosition = rootPart.Position
        savedLookVector = rootPart.CFrame.LookVector
        Config.isMinig = true
        toggleFly(true)
        for i = 1, 2 do
            setMining()
            task.wait(3)
        end
        toggleFly(false)
        Config.isMinig = false
        Events.CancelFishingInputs:InvokeServer()
        task.wait(0.8)
        equipRod()
        rootPart.CFrame = CFrame.new(savedPosition, savedPosition + savedLookVector)
        createPlatform(rootPart.Position)
        task.wait(1.5)
        equipRod()
        task.wait(3)
    end
end)

local function isTargetVariant(variant)
    for _, v in ipairs(mutationTarget) do
        if v == variant then return true end
    end
    return false
end

local function getRootPart()
    local character = LocalPlayer.Character
    if not character then return end
    return character:FindFirstChild("HumanoidRootPart")
end

local PlayerDataReplion = nil
local function GetPlayerDataReplion()
    if PlayerDataReplion then return PlayerDataReplion end
    local ReplionModule = ReplicatedStorage:WaitForChild("Packages"):WaitForChild("Replion", 10)
    if not ReplionModule then return nil end
    local ReplionClient = require(ReplionModule).Client
    PlayerDataReplion = ReplionClient:WaitReplion("Data", 5)
    return PlayerDataReplion
end

local MerchantReplion = nil
local function GetReplions()
    if MerchantReplion then return true end
    local ReplionModule = ReplicatedStorage:WaitForChild("Packages"):WaitForChild("Replion", 10)
    if not ReplionModule then return false end
    local ReplionClient = require(ReplionModule).Client
    MerchantReplion = ReplionClient:WaitReplion("Merchant", 5)
    return MerchantReplion
end

local function GetItemMutationString(item)
    if item.Metadata and item.Metadata.Shiny == true then return "Shiny" end
    return item.Metadata and item.Metadata.VariantId or ""
end

local function GetFishNameAndRarity(item)
    local name = item.Identifier or "Unknown"
    local rarity = item.Metadata and item.Metadata.Rarity or "COMMON"
    local itemID = item.Id

    local itemData = nil
    if ItemUtility and itemID then
        pcall(function()
            itemData = ItemUtility:GetItemData(itemID)
            if not itemData then
                local numericID = tonumber(item.Id) or tonumber(item.Identifier)
                if numericID then
                    itemData = ItemUtility:GetItemData(numericID)
                end
            end
        end)
    end

    if itemData and itemData.Data and itemData.Data.Name then
        name = itemData.Data.Name
    end

    if item.Metadata and item.Metadata.Rarity then
        rarity = item.Metadata.Rarity
    elseif itemData and itemData.Probability and itemData.Probability.Chance and TierUtility then
        local tierObj
        pcall(function()
            tierObj = TierUtility:GetTierFromRarity(itemData.Probability.Chance)
        end)
        if tierObj and tierObj.Name then
            rarity = tierObj.Name
        end
    end

    return name, rarity
end

local ImageURLCache = {}
local function GetRobloxAssetImage(assetId)
    if not assetId or assetId == 0 then return nil end
    if ImageURLCache[assetId] then
        return ImageURLCache[assetId]
    end
    local url = string.format("https://thumbnails.roblox.com/v1/assets?assetIds=%d&size=420x420&format=Png&isCircular=false", assetId)
    local success, response = pcall(game.HttpGet, game, url)
    if success then
        local ok, data = pcall(HttpService.JSONDecode, HttpService, response)
        if ok and data and data.data and data.data[1] and data.data[1].imageUrl then
            local finalUrl = data.data[1].imageUrl
            ImageURLCache[assetId] = finalUrl
            return finalUrl
        end
    end
    return nil
end

local function CensorName(name)
    if not name or type(name) ~= "string" or #name < 1 then
        return "N/A"
    end
    if #name <= 3 then
        return name
    end
    local prefix = name:sub(1, 3)
    local censorString = string.rep("*", #name - 3)
    return prefix .. censorString
end

local function sendExploitWebhook(url, username, embed_data)
    local payload = {
        username = username,
        embeds = {embed_data}
    }
    local json_data = HttpService:JSONEncode(payload)
    if typeof(request) == "function" then
        local success, response = pcall(function()
            return request({
                Url = url,
                Method = "POST",
                Headers = { ["Content-Type"] = "application/json" },
                Body = json_data
            })
        end)
        if success and (response.StatusCode == 200 or response.StatusCode == 204) then
            print("Webhook sent successfully.")
            return true, "Sent"
        elseif success and response.StatusCode then
            print("Failed to send webhook. Status code:", response.StatusCode)
            return false, "Failed: " .. response.StatusCode
        elseif not success then
            print("Error sending webhook:", response)
            return false, "Error: " .. tostring(response)
        end
    end
    return false, "No Request Func"
end

local function getRarityColor(rarity)
    local r = rarity:upper()
    if r == "SECRET" then return 0x00d3a9 end
    if r == "MYTHIC" then return 0xe22b2e end
    if r == "LEGENDARY" then return 0xFF4500 end
    if r == "EPIC" then return 0x8A2BE2 end
    if r == "RARE" then return 0x0000FF end
    if r == "UNCOMMON" then return 0x00FF00 end
    return 0x00BFFF
end

Events.favorite = GetServerRemote("RE/FavoriteItem")

Connections.fishNotifConnection = Events.fishNotif.OnClientEvent:Connect(function(...)
    local args = {...}
    local arg3 = args[3]
    lastTimeFishCaught = os.clock()

    local dummyItem = {Id = args[1], Metadata = args[2]}
    local fishName, fishRarity = GetFishNameAndRarity(dummyItem)
    local fishRarityUpper = fishRarity:upper()

    local isUserFilterMatch = (fishRarityUpper == "SECRET")
    if Config.CustomWebhook then
        if targetWebhookRarities.mythic and fishRarityUpper == "MYTHIC" then isUserFilterMatch = true end
        if targetWebhookRarities.legendary and fishRarityUpper == "LEGENDARY" then isUserFilterMatch = true end
        if targetWebhookRarities.epic and fishRarityUpper == "EPIC" then isUserFilterMatch = true end
        if fishName == "Ruby" and mutationDisplay == "Gemstone" then isUserFilterMatch = true end
        if fishRarityUpper == "MYTHIC" and mutationDisplay == "Crystalized" then isUserFilterMatch = true end
    end

    if typeof(arg3) == "table" and arg3.InventoryItem and arg3.InventoryItem.UUID then
        if Config.InstantPerfectFishing then
            task.wait(0.2)
            Events.CancelFishingInputs:InvokeServer()
            task.wait(0.1)
            Events.charge:InvokeServer(1755848498.4834)
            task.wait(Config.PerfectionValue)
            if g_selectedSkin ~= "Default" and Config.customEffect then
                Override.RodThrow = g_animator:LoadAnimation(AnimationsFolder:WaitForChild(g_selectedSkin .. "RodThrow"))
                Override.RodThrow:Play()
            end
            Events.minigame:InvokeServer(1.2854545116425, 1)
            task.wait(Config.CatchDelay)
            Events.fishing:InvokeServer()
        end
        if isTargetVariant(arg3.InventoryItem.Metadata.VariantId) then
            Events.favorite:FireServer(arg3.InventoryItem.UUID)
        end
        if Config.FavRubyGemstone then
            if arg3.InventoryItem.Id == 243 and arg3.InventoryItem.Metadata.VariantId == "Gemstone" then
                Events.favorite:FireServer(arg3.InventoryItem.UUID)
            end
        end
        lastTimeFishCaught = os.clock()
    end

    if isMobile or fullExecutor then
        if isUserFilterMatch then
            local fishWeight = string.format("%.2fkg", args[2].Weight or 0)
            local mutationString = GetItemMutationString(dummyItem)
            local mutationDisplay = mutationString ~= "" and mutationString or "N/A"
            local itemData = ItemUtility:GetItemData(args[1])

            local assetId
            if itemData and itemData.Data then
                local iconRaw = itemData.Data.Icon or itemData.Data.ImageId
                if iconRaw then
                    assetId = tonumber(string.match(tostring(iconRaw), "%d+"))
                end
            end

            local imageUrl = assetId and GetRobloxAssetImage(assetId)
            task.wait(0.5)
            if not imageUrl then
                imageUrl = "https://tr.rbxcdn.com/53eb9b170bea9855c45c9356fb33c070/420/420/Image/Png"
            end

            local leaderstats = LocalPlayer:FindFirstChild("leaderstats")
            local caughtStat = leaderstats and leaderstats:FindFirstChild("Caught")
            local caughtDisplay = caughtStat and FormatNumber(caughtStat.Value) or "N/A"

            local currentCoins = 0
            local replion = GetPlayerDataReplion()
            if replion then
                local success_curr, CurrencyConfig = pcall(function()
                    return require(game:GetService("ReplicatedStorage").Modules.CurrencyUtility.Currency)
                end)
                if success_curr and CurrencyConfig and CurrencyConfig["Coins"] then
                    currentCoins = replion:Get(CurrencyConfig["Coins"].Path) or 0
                else
                    currentCoins = replion:Get("Coins") or replion:Get({"Coins"}) or 0
                end
            else
                if leaderstats then
                    local coinStat = leaderstats:FindFirstChild("Coins") or leaderstats:FindFirstChild("C$")
                    currentCoins = coinStat and coinStat.Value or 0
                end
            end
            local formattedCoins = FormatNumber(currentCoins)

            local playerName = LocalPlayer.DisplayName or LocalPlayer.Name
            local censoredPlayerName = CensorName(playerName)

            local title_global = ":tropical_fish: Ada Notification NOXIUS!!! :tropical_fish:"

            local globalEmbed = {
                title = title_global,
                description = string.format("Si **%s** baru aja nangkap **%s** dengan mutasi **%s**!!!", censoredPlayerName, fishName, mutationDisplay),
                color = getRarityColor(fishRarityUpper),
                fields = {
                    { name = "<a:ARROW:1438758883203223605> Rarity", value = string.format("`%s`", fishRarityUpper), inline = true },
                    { name = "<a:ARROW:1438758883203223605> Weight", value = string.format("`%s`", fishWeight), inline = true },
                    { name = "<a:ARROW:1438758883203223605> Mutation", value = string.format("`%s`", mutationDisplay), inline = true },
                    { name = "<a:ARROW:1438758883203223605> Date", value = string.format("`%s`", os.date("%Y-%m-%d %H:%M:%S")), inline = true },
                },
                thumbnail = { url = imageUrl },
                footer = {
                    text = "NOXIUS HUB | Freemium"
                }
            }

            GLOBAL_WEBHOOK_USERNAME = "NOXIUS HUB - Fishing Notifier"
            if isUserFilterMatch then
                if Config.CustomWebhook then
                    sendExploitWebhook(Config.CustomWebhookUrl, GLOBAL_WEBHOOK_USERNAME, globalEmbed)
                else
                    sendExploitWebhook(Config.WebhookUrl, GLOBAL_WEBHOOK_USERNAME, globalEmbed)
                end
            end
        end
    end
end)

task.spawn(function()
    while true do
        task.wait(3)
        if not Config.isFarming or not Config.isMinig then
            if Config.UB.Active and lastTimeFishCaught ~= nil and os.clock() - lastTimeFishCaught >= 5 and blatantFishCycleCount > 1 then
                needCast = true
                print("stuckkk")
                blatantFishCycleCount = 0
                lastTimeFishCaught = os.clock()
            end
        end
    end
end)

local Window = WindUI:CreateWindow({
    Title = "Noxius Community",
    Icon = "rbxassetid://77194008928196",
    Author = "Noxius | Team",
    Folder = "ASSETS_HUB",
    Size = UDim2.fromOffset(260, 290),
    Transparent = true,
    Theme = "Indigo",
    SideBarWidth = 170,
    HasOutline = true,
    User = {
        Enabled = true,
        Anonymous = true,
    },
})

Window:EditOpenButton({Enabled = false})

local CollectionService = game:GetService("CollectionService")
local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local G2L = {}

G2L["ScreenGui_1"] = Instance.new("ScreenGui")
G2L["ScreenGui_1"].Parent = game:GetService("CoreGui")
G2L["ScreenGui_1"].ZIndexBehavior = Enum.ZIndexBehavior.Sibling
G2L["ScreenGui_1"].ResetOnSpawn = false
CollectionService:AddTag(G2L["ScreenGui_1"], "main")

G2L["ButtonRezise_2"] = Instance.new("ImageButton")
G2L["ButtonRezise_2"].Parent = G2L["ScreenGui_1"]
G2L["ButtonRezise_2"].BorderSizePixel = 0
G2L["ButtonRezise_2"].Draggable = true
G2L["ButtonRezise_2"].BackgroundColor3 = Color3.fromRGB(200, 0, 255)   -- ‚Üê Ubah ke ungu
G2L["ButtonRezise_2"].Image = "rbxassetid://77194008928196"
G2L["ButtonRezise_2"].Size = UDim2.new(0, 47, 0, 47)
G2L["ButtonRezise_2"].Position = UDim2.new(0.13, 0, 0.03, 0)
G2L["ButtonRezise_2"].Visible = true

local corner = Instance.new("UICorner", G2L["ButtonRezise_2"])
corner.CornerRadius = UDim.new(0, 8)

local neon = Instance.new("UIStroke", G2L["ButtonRezise_2"])
neon.Thickness = 2
neon.Color = Color3.fromRGB(200, 0, 255)          -- ‚Üê Stroke juga jadi ungu
neon.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

local windowVisible = true

G2L["ButtonRezise_2"].MouseButton1Click:Connect(function()
	if windowVisible then
		Window:Close()
	else
		Window:Open()
	end
	windowVisible = not windowVisible
end)

Window:Tag({
    Title = "BETA TESTER",
    Color = Color3.fromRGB(200, 0, 255),   -- ‚Üê Ubah ke ungu cerah
    Radius = 17,
})

Window:Tag({
    Title = "DEAD GAME!",
    Color = Color3.fromRGB(200, 0, 255),   -- ‚Üê Ubah ke ungu cerah (sama supaya konsisten)
    Radius = 17,
})

WindUI:Notify({
    Title = "All Fitur Loaded",
    Content = "UI loaded successfully!",
    Duration = 3,
    Icon = "bell",
})

local Tab1 = Window:Tab({ 
    Title = "Info",
    Icon = "rbxassetid://7733964719",
})

Tab1:Section({
    Title = "Community Support",
    Icon = "chevrons-left-right-ellipsis",
    TextXAlignment = "Left",
    TextSize = 17,
})

Tab1:Divider()

Tab1:Button({
    Title = "Discord",
    Desc = "click to copy link",
    Callback = function()
        if setclipboard then
            setclipboard("https://discord.gg/noxius")
        end
    end
})

Tab1:Divider()

Tab1:Paragraph({
    Title = "Support",
    Desc = "Join Us! Dapatkan update terbaru, support, dan komunitas Noxius di sini."
})

Tab1:Divider()

Tab1:Keybind({
    Title = "Close/Open UI",
    Desc = "Keybind to Close/Open UI",
    Value = "G",
    Callback = function(v)
        Window:SetToggleKey(Enum.KeyCode[v])
    end
})

local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local Character = Player.Character or Player.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid")

local Tab2 = Window:Tab({
    Title = "Players",
    Icon = "rbxassetid://7743875962",
})

Tab2:Slider({
    Title = "Speed",
    Desc = false,
    Step = 1,
    Value = {
        Min = 18,
        Max = 100,
        Default = 18,
    },
    Callback = function(Value)
        if game.Players.LocalPlayer.Character then
            local humanoid = game.Players.LocalPlayer.Character:FindFirstChild("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = Value
            end
        end
    end
})

Tab2:Slider({
    Title = "Jump",
    Desc = false,
    Step = 1,
    Value = {
        Min = 50,
        Max = 500,
        Default = 50,
    },
    Callback = function(Value)
        _G.CustomJumpPower = Value
        if game.Players.LocalPlayer.Character then
            local humanoid = game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.UseJumpPower = true
                humanoid.JumpPower = Value
            end
        end
    end
})

Tab2:Divider()

Tab2:Button({
    Title = "Reset Jump Power",
    Desc = "Return Jump Power to normal (50)",
    Callback = function()
        _G.CustomJumpPower = 50
        local humanoid = game:GetService("Players").LocalPlayer.Character and game:GetService("Players").LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid.UseJumpPower = true
            humanoid.JumpPower = 50
        end
    end
})

Player.CharacterAdded:Connect(function(char)
    local humanoid = char:WaitForChild("Humanoid")
    humanoid.UseJumpPower = true
    humanoid.JumpPower = _G.CustomJumpPower or 50
end)

Tab2:Button({
    Title = "Reset Speed",
    Desc = "Return speed to normal (18)",
    Callback = function()
        if Humanoid then
            Humanoid.WalkSpeed = 18
        end
    end
})

Tab2:Divider()

local UserInputService = game:GetService("UserInputService")

Tab2:Toggle({
    Title = "Infinite Jump",
    Desc = "activate to use infinite jump",
    Icon = false,
    Type = false,
    Default = false,
    Callback = function(state)
        _G.InfiniteJump = state
    end
})

UserInputService.JumpRequest:Connect(function()
    if _G.InfiniteJump then
        local character = Player.Character or Player.CharacterAdded:Wait()
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
        end
    end
end)

Tab2:Toggle({
    Title = "Noclip",
    Desc = "Walk through walls",
    Icon = false,
    Type = false,
    Default = false,
    Callback = function(state)
        _G.Noclip = state
        task.spawn(function()
            local Player = game:GetService("Players").LocalPlayer
            while _G.Noclip do
                task.wait(0.1)
                if Player.Character then
                    for _, part in pairs(Player.Character:GetDescendants()) do
                        if part:IsA("BasePart") and part.CanCollide == true then
                            part.CanCollide = false
                        end
                    end
                end
            end
        end)
    end
})

local player = game:GetService("Players").LocalPlayer
local freezeConnection
local originalCFrame

Tab2:Toggle({
    Title = "Freeze Character",
    Default = false,
    Callback = function(state)
        _G.FreezeCharacter = state
        if state then
            local character = game.Players.LocalPlayer.Character
            if character then
                local root = character:FindFirstChild("HumanoidRootPart")
                if root then
                    originalCFrame = root.CFrame
                    freezeConnection = game:GetService("RunService").Heartbeat:Connect(function()
                        if _G.FreezeCharacter and root then
                            root.CFrame = originalCFrame
                        end
                    end)
                end
            end
        else
            if freezeConnection then
                freezeConnection:Disconnect()
                freezeConnection = nil
            end
        end
    end
})

player.CharacterAdded:Connect(function(char)
    if _G.FreezeCharacter then
        task.wait(0.5)
        local root = char:FindFirstChild("HumanoidRootPart")
        if root then
            root.CFrame = originalCFrame
        end
    end
end)

local Tab3 = Window:Tab({
    Title = "Main",
    Icon = "rbxassetid://7733779610"
})

Tab3:Section({
    Title = "Fishing Controls",
    Icon = "fish",
})

Tab3:Toggle({
    Title = "Fast Reel",
    Default = false,
    Callback = function(state)
        onToggleUB(state)
    end
})

Tab3:Input({
    Title = "Top Delay",
    Placeholder = tostring(Config.UB.Settings.CompleteDelay),
    Default = tostring(Config.UB.Settings.CompleteDelay),
    Callback = function(Text)
        local num = tonumber(Text)
        if num then
            Config.UB.Settings.CompleteDelay = num
            WindUI:Notify({
                Title = "Updated",
                Content = "Top Delay diubah ke " .. num .. " detik",
                Duration = 2
            })
        end
    end
})

Tab3:Toggle({
    Title = "Legit Fishing",
    Default = Config.AutoCatch,
    Callback = function(state)
        Config.AutoCatch = state
        if state then
            equipRod()
            if Connections.exclaim then
                Connections.exclaim:Disconnect()
            end
            Connections.exclaim = Events.exclaimEvent.OnClientEvent:Connect(function(data)
                if not data or not data.TextData or data.TextData.EffectType ~= "Exclaim" then return end
                local container = data.Container
                if not container then return end
                if typeof(container) ~= "Instance" or tostring(container.Parent) ~= tostring(LocalPlayer.Name) then return end
                if Config.AutoCatch then
                    task.wait(Config.CatchDelay - 0.1)
                    Events.fishing:InvokeServer()
                end
            end)
            Events.UpdateAutoFishingState:InvokeServer(true)
        else
            Events.UpdateAutoFishingState:InvokeServer(false)
            if Connections.exclaim then
                Connections.exclaim:Disconnect()
                Connections.exclaim = nil
            end
        end
    end
})

Tab3:Input({
    Title = "Legit Catch Delay",
    Placeholder = tostring(Config.CatchDelay),
    Default = tostring(Config.CatchDelay),
    Callback = function(Text)
        local num = tonumber(Text)
        if num and num >= 0.7 and num <= 1.5 then
            Config.CatchDelay = num
            WindUI:Notify({
                Title = "Updated",
                Content = "Catch Delay diubah ke " .. num .. " detik",
                Duration = 2
            })
        else
            WindUI:Notify({
                Title = "Invalid Input",
                Content = "Masukkan angka antara 0.7 sampai 1.5",
                Duration = 3
            })
        end
    end
})

Tab3:Toggle({
    Title = "Random Cast",
    Default = Config.antiOKOK,
    Callback = function(state)
        Config.antiOKOK = state
    end
})

if isMobile then
    Tab3:Toggle({
        Title = "Mode Perfection Enchant",
        Description = "Spam Perfection / Good secara otomatis",
        Default = false,
        Callback = function(Value)
            Config.autoFishing = Value
            if Value then
                if not origCharge then
                    origCharge = FishingController.RequestChargeFishingRod
                    origCast   = FishingController.SendFishingRequestToServer
                end
                FishingController.RequestChargeFishingRod = function(self, ...) return end
                FishingController.SendFishingRequestToServer = function(self, ...) return end
                Events.UpdateAutoFishingState:InvokeServer(true)
            else
                if origCharge and origCast then
                    FishingController.RequestChargeFishingRod = origCharge
                    FishingController.SendFishingRequestToServer = origCast
                end
                Events.UpdateAutoFishingState:InvokeServer(false)
            end
        end
    })
end

Tab3:Section({
    Title = "Sell & Totem Controls",
    Icon = "dollar-sign",
})

Tab3:Toggle({
    Title = "Auto Sell",
    Description = "Otomatis jual ikan (atur filter di tas: Secret/Mythic/Legendary dll)",
    Default = Config.AutoSell,
    Callback = function(Value)
        Config.AutoSell = Value
        if Value then
            Tasks.autoSellTask = task.spawn(autoSell)
        else
            if Tasks.autoSellTask then
                task.cancel(Tasks.autoSellTask)
                Tasks.autoSellTask = nil
            end
        end
    end
})

Tab3:Input({
    Title = "Sell Delay (Minute)",
    Placeholder = tostring(Config.SellDelay),
    Default = tostring(Config.SellDelay),
    Callback = function(Text)
        local num = tonumber(Text)
        if num and num > 0 then
            Config.SellDelay = num
            WindUI:Notify({
                Title = "Updated",
                Content = "Sell delay diubah ke " .. num .. " menit",
                Duration = 2
            })
        else
            WindUI:Notify({
                Title = "Invalid",
                Content = "Masukkan angka lebih dari 0",
                Duration = 3
            })
        end
    end
})

Tab3:Button({
    Title = "Sell All Now",
    Description = "Jual semua item non-favorit seketika",
    Callback = function()
        sellAll()
        WindUI:Notify({
            Title = "Selling",
            Content = "Menjual semua item non-favorit...",
            Duration = 2
        })
    end
})

if isMobile then
    Events.SpawnTotem = GetServerRemote("RE/SpawnTotem")

    Tab3:Section({
        Title = "Totem Controls",
        Icon = "sparkles",
    })

    local totemData = {
        ["Pilih Totem"] = 0,
        ["Luck Totem"] = 1,
        ["Mutation Totem"] = 2,
        ["Shiny Totem"] = 3,
        ["Love Totem"] = 5
    }

    local selectedTotemID = 0

    local dropdownInstance = Tab3:Dropdown({
        Title = "Choose Totem",
        Description = "Pilih totem yang ingin di-spawn otomatis",
        Options = { "Pilih Totem", "Luck Totem", "Mutation Totem", "Shiny Totem", "Love Totem" },
        Default = "Pilih Totem",
        Callback = function(selected)
            selectedTotemID = totemData[selected] or 0
            print("Totem dipilih: " .. selected .. " (ID: " .. selectedTotemID .. ")")
        end
    })

    task.delay(0.5, function()
        if dropdownInstance and dropdownInstance.Refresh then
            dropdownInstance:Refresh({ "Pilih Totem", "Luck Totem", "Mutation Totem", "Shiny Totem", "Love Totem" }, true)
            print("Dropdown refreshed via Refresh method")
        else
            print("Dropdown instance tidak punya Refresh, coba restart UI atau cek WindUI version")
        end
    end)

    Tab3:Toggle({
        Title = "Auto Spawn 1 Totem",
        Description = "Spawn totem setiap 1 jam (minimal 1 totem di inventory)",
        Default = false,
        Callback = function(Value)
            if Value then
                Tasks.totemTask = task.spawn(function()
                    while true do
                        local hrp = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                        if not hrp then
                            task.wait(10)
                            continue
                        end

                        local totemUUIDs = {}
                        pcall(function()
                            local inv = PlayerData:GetExpect("Inventory")
                            if inv and inv.Totems and #inv.Totems > 0 then
                                for _, item in ipairs(inv.Totems) do
                                    if selectedTotemID == 0 or selectedTotemID == item.Id then
                                        table.insert(totemUUIDs, item.UUID)
                                        print("Totem ditemukan - ID: " .. item.Id .. ", UUID: " .. item.UUID)
                                    end
                                end
                                if #totemUUIDs == 0 then
                                    print("Tidak ada totem dengan ID " .. selectedTotemID .. " di inventory")
                                end
                            else
                                print("Inventory atau Totems tidak ditemukan")
                            end
                        end)

                        if #totemUUIDs > 0 then
                            Events.SpawnTotem:FireServer(totemUUIDs[1])
                            task.wait(3)
                            Events.fishing:InvokeServer()
                            Events.equip:FireServer(1)
                            task.wait(1)
                            equipRod()
                            print("Totem spawned berhasil")
                        else
                            task.wait(30)
                        end

                        task.wait(60 * 60)
                    end
                end)
            else
                if Tasks.totemTask then
                    task.cancel(Tasks.totemTask)
                    Tasks.totemTask = nil
                    print("Auto Spawn Totem dimatikan")
                end
            end
        end
    })
end

Tab3:Divider()

-- === TAB 4: AUTOMATION (MODIFIED) ===
local Tab4 = Window:Tab({
    Title = "Automation",
    Icon = "rbxassetid://7733779610"
})

-- Section: Weather Automation
Tab4:Section({
    Title = "Weather Automation",
    Icon = "cloud-rain",
})

local weatherOptions = { "Storm", "Cloudy", "Snow", "Wind", "Radiant" }
Events.weather = GetServerRemote("RF/PurchaseWeatherEvent")

local function buyAllWeather()
    for _, weatherOption in ipairs(weatherOptions) do
        pcall(function() Events.weather:InvokeServer(weatherOption) end)
        task.wait(1)
    end
end

Tab4:Toggle({
    Title = "Auto Weather",
    Description = "Otomatis beli semua cuaca setiap 15 menit",
    Default = Config.autoWeather,
    Callback = function(Value)
        Config.autoWeather = Value
        if Value then
            Tasks.weatherTask = task.spawn(function()
                while Config.autoWeather do
                    buyAllWeather()
                    task.wait(15 * 60)
                end
            end)
        else
            if Tasks.weatherTask then
                task.cancel(Tasks.weatherTask)
                Tasks.weatherTask = nil
            end
        end
    end
})

Tab4:Button({
    Title = "Buy All Weather Now",
    Description = "Beli semua cuaca sekaligus",
    Callback = function()
        buyAllWeather()
        WindUI:Notify({
            Title = "Success",
            Content = "Semua cuaca telah dibeli!",
            Duration = 2
        })
    end
})

Tab4:Divider()

-- Section: Teleport Controls
Tab4:Section({
    Title = "Teleport Controls",
    Icon = "navigation",
})

-- Build location names from LOCATIONS table
local locationNames = {}
for name in pairs(LOCATIONS) do
    table.insert(locationNames, name)
end
table.sort(locationNames)

-- Create Location Dropdown
local locationDropdown = Tab4:Dropdown({
    Title = "Select Location",
    Description = "Pilih tempat untuk teleport",
    Options = locationNames,
    Default = locationNames[1] or "--",
    Callback = function(selectedName)
        if LOCATIONS[selectedName] then
            teleportTo(selectedName)
        end
    end
})

-- Player List Variables
local playerList = {}
local playerDropdown = nil

local function updatePlayerList()
    playerList = {}
    for _, player in ipairs(game.Players:GetPlayers()) do
        if player ~= LocalPlayer then
            table.insert(playerList, player.Name)
        end
    end
    table.sort(playerList)
    return playerList
end

-- Create Player Dropdown Section
Tab4:Paragraph({
    Title = "Teleport to Player",
    Content = "--- Players ---"
})

local function createPlayerDropdown()
    -- Hapus dropdown lama jika ada (untuk recreate)
    if playerDropdown and playerDropdown.Destroy then
        pcall(function() playerDropdown:Destroy() end)
    end

    updatePlayerList()

    if #playerList == 0 then
        Tab4:Paragraph({
            Title = "Info",
            Content = "Tidak ada pemain lain yang ditemukan."
        })
        return
    end

    playerDropdown = Tab4:Dropdown({
        Title = "Teleport to Player",
        Description = "Pilih pemain untuk diteleportasi",
        Options = playerList,
        Default = playerList[1],
        Callback = function(selectedPlayerName)
            local targetPlayer = game.Players:FindFirstChild(selectedPlayerName)
            if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local localChar = LocalPlayer.Character
                if localChar and localChar:FindFirstChild("HumanoidRootPart") then
                    localChar.HumanoidRootPart.CFrame = targetPlayer.Character.HumanoidRootPart.CFrame + Vector3.new(0, 3, 0)
                end
            end
        end
    })
end

-- Initial create
createPlayerDropdown()

-- Refresh Button
Tab4:Button({
    Title = "Refresh Player List",
    Description = "Update daftar pemain",
    Callback = function()
        -- Coba pakai Refresh() dulu (jika WindUI support)
        if playerDropdown and playerDropdown.Refresh then
            updatePlayerList()
            playerDropdown:Refresh(playerList, playerList[1])
        else
            -- Fallback: recreate dropdown
            createPlayerDropdown()
        end
        WindUI:Notify({
            Title = "Refreshed",
            Content = "Daftar pemain diupdate (" .. #playerList .. " pemain)",
            Duration = 2
        })
    end
})

-- Event listeners untuk update otomatis
game.Players.PlayerAdded:Connect(function()
    task.defer(function()
        if playerDropdown and playerDropdown.Refresh then
            updatePlayerList()
            playerDropdown:Refresh(playerList, playerList[1])
        else
            createPlayerDropdown()
        end
    end)
end)

game.Players.PlayerRemoving:Connect(function()
    task.defer(function()
        if playerDropdown and playerDropdown.Refresh then
            updatePlayerList()
            playerDropdown:Refresh(playerList, playerList[1])
        else
            createPlayerDropdown()
        end
    end)
end)

Tab4:Divider()

local Tab5 = Window:Tab({
    Title = "Farming",
    Icon = "pickaxe",
})

Tab5:Section({
    Title = "Crystal Mining",
    Icon = "gem",
})

-- Fly function persis dari kode kamu
local RunService = game:GetService("RunService")
local Camera = workspace.CurrentCamera
local Speed = 80
local function toggleFly(enabled)
    local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local hrp = character:WaitForChild("HumanoidRootPart")

    if enabled then
        FlyForce = Instance.new("BodyVelocity")
        FlyForce.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
        FlyForce.P = 9e3
        FlyForce.Velocity = Vector3.zero
        FlyForce.Parent = hrp

        Connections.flyConnection = RunService.RenderStepped:Connect(function()
            local moveDir = ControlModule:GetMoveVector()
            local camCF = Camera.CFrame
            local velocity = Vector3.zero
            velocity += camCF.RightVector * moveDir.X * Speed
            velocity -= camCF.LookVector * moveDir.Z * Speed
            FlyForce.Velocity = velocity
        end)
    else
        if Connections.flyConnection then
            Connections.flyConnection:Disconnect()
            Connections.flyConnection = nil
        end
        if FlyForce then
            FlyForce:Destroy()
            FlyForce = nil
        end
    end
end

-- Manual Mining button persis
Tab5:Button({
    Title = "Manual Mining",
    Description = "Nambang crystal manual (2x loop + fly + reset rod)",
    Callback = function()
        getAxeUUID()
        local args = {
            Config.axeUuid, "Gears"
        }
        local rootPart = getRootPart()
        local origLocation = rootPart.CFrame
        savedPosition = rootPart.Position
        savedLookVector = rootPart.CFrame.LookVector
        Config.isMinig = true
        toggleFly(true)
        for i = 1,2 do
            setMining()
            task.wait(3)
        end
        toggleFly(false)
        Config.isMinig = false
        Events.CancelFishingInputs:InvokeServer()
        task.wait(0.8)
        equipRod()
        rootPart.CFrame = CFrame.new(savedPosition, savedPosition + savedLookVector)
        createPlatform(rootPart.Position)
        task.wait(1.5)
        equipRod()
        task.wait(3)
    end
})

-- Auto Mining toggle persis
Tab5:Toggle({
    Title = "Auto Mining Crystal",
    Description = "Otomatis nambamng kristal",
    Default = Config.AutoMining,
    Callback = function(Value)
        Config.AutoMining = Value
        if Value then
            getAxeUUID()
            local args = {
                Config.axeUuid, "Gears"
            }
            Events.equipItem:FireServer(unpack(args))
        else
            -- kalau mau stop task
        end
    end
})

-- Auto start mobile
if Config.AutoMining and isMobile then 
    sellAll()
    getAxeUUID()
    local args = {
        Config.axeUuid, "Gears"
    }
    Events.equipItem:FireServer(unpack(args))
    print("automining updated")
    getAxeUUID()
end

Tab5:Divider()

-- Tambahan Auto Favorite Mutations (persis kode kamu)
Tab5:Section({
    Title = "Auto Favorite Mutations",
    Icon = "star",
})

-- List mutation persis dari kode kamu
local mutations = {
    "Gemstone", "Fairy Dust", "Cupid", "Leviathan Rage", "Crystalized", "Color Burn", "Lightning", "Noob", "Radioactive", "Midnight",  "Holographic", "Bloodmoon", "Festive", "Galaxy", "Albino", "Gold", "Frozen", "Corrupt"
}

-- Toggle khusus RUBY GEMSTONE
Tab5:Toggle({
    Title = "RUBY GEMSTONE",
    Description = "Husus Ruby Gemstone",
    Default = Config.FavRubyGemstone,
    Callback = function(Value)
        Config.FavRubyGemstone = Value
    end
})

-- Loop toggle untuk setiap mutation
for _, name in ipairs(mutations) do
    Tab5:Toggle({
        Title = name,
        Default = isTargetVariant(name),  -- asumsi function ini sudah ada
        Callback = function(state)
            if state then
                if not table.find(mutationTarget, name) then
                    table.insert(mutationTarget, name)
                end
            else
                -- RemoveValue (kalau belum ada, aku tambahin definisi sederhana di bawah)
                for i, v in ipairs(mutationTarget) do
                    if v == name then
                        table.remove(mutationTarget, i)
                        break
                    end
                end
            end
            -- Optional: save config kalau perlu
            -- SaveAllConfig() kalau ada function save
        end
    })
end

-- Definisi RemoveValue kalau belum ada (sederhana)
local function RemoveValue(tbl, value)
    for i, v in ipairs(tbl) do
        if v == value then
            table.remove(tbl, i)
            return
        end
    end
end

Tab5:Divider()

local Tab6 = Window:Tab({
    Title = "Misc",
    Icon = "settings",
})

Tab6:Section({
    Title = "Visual & Notification",
    Icon = "eye-off",
})

if not isMobile then
    Tab6:Paragraph({
        Title = "Info",
        Content = "Fitur ini hanya tersedia di mobile."
    })
else
    local origPlaySmallItemObtained = NotificationController.PlaySmallItemObtained

    local function DisablePlaySmallItemObtained()
        NotificationController.PlaySmallItemObtained = function() end
    end

    local function EnablePlaySmallItemObtained()
        NotificationController.PlaySmallItemObtained = origPlaySmallItemObtained
    end

    Tab6:Toggle({
        Title = "Disable Pop Up Fish Notif",
        Description = "Hapus pop up ketika menangkap ikan",
        Default = Config.DisablePopUp,
        Callback = function(Value)
            Config.DisablePopUp = Value
            if Value then
                DisablePlaySmallItemObtained()
            else
                EnablePlaySmallItemObtained()
            end
        end
    })

    if Config.DisablePopUp then
        DisablePlaySmallItemObtained()
    end

    local _backup = setmetatable({}, { __mode = "k" })

    local function DisableController(controller)
        if _backup[controller] then
            return
        end

        local data = {
            functions = {},
            metatable = getmetatable(controller),
        }

        for k, v in pairs(controller) do
            if type(v) == "function" then
                data.functions[k] = v
                controller[k] = function() end
            end
        end

        local mt = data.metatable or {}
        mt.__index = function(_, key)
            if data.functions[key] then
                return function() end
            end
            return nil
        end
        mt.__newindex = function() end

        setmetatable(controller, mt)
        _backup[controller] = data
    end

    local function EnableController(controller)
        local data = _backup[controller]
        if not data then
            return
        end

        for k, v in pairs(data.functions) do
            controller[k] = v
        end

        setmetatable(controller, data.metatable)
        _backup[controller] = nil
    end

    Tab6:Toggle({
        Title = "Disable VFX",
        Description = "Hapus efek dan suara skin",
        Default = Config.DisableVfx,
        Callback = function(Value)
            Config.DisableVfx = Value
            if Value then
                DisableController(VFXController)
            else
                EnableController(VFXController)
            end
        end
    })

    if Config.DisableVfx then
        DisableController(VFXController)
    end

    Tab6:Toggle({
        Title = "Disable Cutscene",
        Description = "Hapus animasi tangkapan ikan",
        Default = Config.DisableCutscene,
        Callback = function(Value)
            Config.DisableCutscene = Value
            if Value then
                DisableController(CutsceneController)
            else
                EnableController(CutsceneController)
            end
        end
    })

    if Config.DisableCutscene then
        DisableController(CutsceneController)
    end
end  -- END untuk blok if not isMobile

Tab6:Divider()

local Tab7 = Window:Tab({
    Title = "Market",
    Icon = "shopping-bag",
})

Tab7:Section({
    Title = "Merchant Controls",
    Icon = "store",
})

Tab7:Toggle({
    Title = "Toggle Market / Merchant",
    Description = "Buka/tutup GUI Merchant",
    Default = false,
    Callback = function(Value)
        local merchantGui = game:GetService("Players").LocalPlayer.PlayerGui:FindFirstChild("Merchant")
        if merchantGui then
            merchantGui.Enabled = Value
        else
            WindUI:Notify({
                Title = "Error",
                Content = "GUI Merchant tidak ditemukan!",
                Duration = 3
            })
        end
    end
})

Tab7:Section({
    Title = "Special Market Item",
    Icon = "gift",
})

Tab7:Button({
    Title = "Love Totem",
    Description = "Beli Loving Boost Totem",
    Callback = function()
        local Event = GetServerRemote("RE/LimitedPurchaseRequest")
        if Event then
            pcall(function()
                Event:FireServer(2)
            end)
        end

        local EventReverse = GetServerRemoteReverse("RE/LimitedPurchaseRequest")
        if EventReverse then
            pcall(function()
                EventReverse:FireServer(2)
            end)
        end

        WindUI:Notify({
            Title = "Market",
            Content = "Mencoba beli Loving Boost Totem...",
            Duration = 2
        })
    end
})

Tab7:Divider()

local Tab8 = Window:Tab({
    Title = "Settings",
    Icon = "cog",
})

Tab8:Section({
    Title = "Player Customization",
    Icon = "user",
})

-- Hide All Usernames (persis dari sebelumnya)
local customName = "NOXIUS HUB"
local customLevel = "Adalah Pokoknya"
local hideNameConnections = {}

local function applyHideNameToCharacter(character, player)
    if not character or not player then return end

    local humanoid = character:FindFirstChildOfClass("Humanoid")
    if humanoid then
        humanoid.DisplayName = customName
    end

    for _, obj in ipairs(character:GetDescendants()) do
        if obj:IsA("BillboardGui") then
            for _, lbl in ipairs(obj:GetDescendants()) do
                if (lbl:IsA("TextLabel") or lbl:IsA("TextButton")) and lbl.Visible then
                    local txt = lbl.Text
                    if txt:find(player.Name) or txt:find(player.DisplayName) then
                        lbl.Text = customName
                    elseif txt:match("%d+") or txt:lower():find("lvl") or txt:lower():find("level") then
                        if #txt < 15 then
                            lbl.Text = customLevel
                        end
                    end
                end
            end
        end
    end

    local conn = character.DescendantAdded:Connect(function(desc)
        if Config.HideUsn and desc:IsA("BillboardGui") then
            task.wait()
            for _, lbl in ipairs(desc:GetDescendants()) do
                if (lbl:IsA("TextLabel") or lbl:IsA("TextButton")) and lbl.Visible then
                    local txt = lbl.Text
                    if txt:find(player.Name) or txt:find(player.DisplayName) then
                        lbl.Text = customName
                    elseif txt:match("%d+") or txt:lower():find("lvl") or txt:lower():find("level") then
                        if #txt < 15 then
                            lbl.Text = customLevel
                        end
                    end
                end
            end
        end
    end)
    table.insert(hideNameConnections, conn)
end

local function cleanupConnections()
    for _, connection in ipairs(hideNameConnections) do
        if connection then
            connection:Disconnect()
        end
    end
    hideNameConnections = {}
end

Tab8:Toggle({
    Title = "Hide All Usernames (Streamer Mode)",
    Description = "Menyembunyikan nama dan level pemain.",
    Default = Config.HideUsn,
    Callback = function(state)
        Config.HideUsn = state
        if state then
            for _, player in ipairs(game.Players:GetPlayers()) do
                if player.Character then
                    applyHideNameToCharacter(player.Character, player)
                end
            end
        else
            cleanupConnections()
            for _, player in ipairs(game.Players:GetPlayers()) do
                if player.Character then
                    local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
                    if humanoid then
                        humanoid.DisplayName = player.DisplayName
                    end
                end
            end
        end

        pcall(function()
            game:GetService("StarterGui"):SetCoreGuiEnabled(Enum.CoreGuiType.PlayerList, not state)
        end)
    end
})

if Config.HideUsn then
    for _, player in ipairs(game.Players:GetPlayers()) do
        if player.Character then
            applyHideNameToCharacter(player.Character, player)
        end
    end
    pcall(function()
        game:GetService("StarterGui"):SetCoreGuiEnabled(Enum.CoreGuiType.PlayerList, false)
    end)
end

-- Speed Hack
local originalWalkSpeed = 0
local function toggleSpeedHack(enabled)
    local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
    if not humanoid then return end

    if originalWalkSpeed == 0 then
        originalWalkSpeed = humanoid.WalkSpeed
    end

    if enabled then
        humanoid.WalkSpeed = Config.SpeedHackValue
        if Connections.speedChanged then
            Connections.speedChanged:Disconnect()
        end
        Connections.speedChanged = humanoid:GetPropertyChangedSignal("WalkSpeed"):Connect(function()
            if Config.SpeedHack and humanoid.WalkSpeed ~= Config.SpeedHackValue then
                humanoid.WalkSpeed = Config.SpeedHackValue
            end
        end)
    else
        if Connections.speedChanged then
            Connections.speedChanged:Disconnect()
            Connections.speedChanged = nil
        end
        humanoid.WalkSpeed = originalWalkSpeed
    end
end

Tab8:Toggle({
    Title = "Speed Hack",
    Description = "Aktifkan speed hack",
    Default = false,
    Callback = function(Value)
        Config.SpeedHack = Value
        toggleSpeedHack(Value)
    end
})

-- Fly toggle
Tab8:Toggle({
    Title = "Fly",
    Default = false,
    Callback = toggleFly
})

-- No Fall
local function removePlatform()
    if platform then
        platform:Destroy()
        platform = nil
    end
end

local function startNoFall()
    if isNoFallActive then return end
    isNoFallActive = true
    Connections.noFallConnection = RunService.Heartbeat:Connect(function()
        local character = LocalPlayer.Character
        if not character then return end
        local root = character:FindFirstChild("HumanoidRootPart")
        local humanoid = character:FindFirstChild("Humanoid")
        if not root or not humanoid then return end

        if humanoid.FloorMaterial == Enum.Material.Air then
            createPlatform(root.Position)
        end

        if platform then
            local distance = (root.Position - platform.Position).Magnitude
            if distance > SAFE_DISTANCE then removePlatform() end
        end
    end)
end

local function stopNoFall()
    if not isNoFallActive then return end
    isNoFallActive = false
    if Connections.noFallConnection then
        Connections.noFallConnection:Disconnect()
        Connections.noFallConnection = nil
    end
    removePlatform()
end

Tab8:Toggle({
    Title = "No Fall",
    Default = false,
    Callback = function(Value)
        if Value then
            if LocalPlayer.Character then startNoFall() end
            if Connections.characterAddedConnection then Connections.characterAddedConnection:Disconnect() end
            Connections.characterAddedConnection = LocalPlayer.CharacterAdded:Connect(function(char)
                task.wait(1)
                if Config.NoFall then startNoFall() end
            end)
        else
            stopNoFall()
            if Connections.characterAddedConnection then
                Connections.characterAddedConnection:Disconnect()
                Connections.characterAddedConnection = nil
            end
        end
    end
})

-- Walk on Water
local waterPlatform = nil
local UserInputService = game:GetService("UserInputService")
local function walkOnWater()
    if not waterPlatform then
        waterPlatform = Instance.new("Part")
        waterPlatform.Name = "WaterPlatform"
        waterPlatform.Anchored = true
        waterPlatform.CanCollide = true
        waterPlatform.Transparency = 1
        waterPlatform.Size = Vector3.new(15, 1, 15)
        waterPlatform.Parent = workspace
    end

    if Connections.walkOnWaterConnection then Connections.walkOnWaterConnection:Disconnect() end

    Connections.walkOnWaterConnection = game:GetService("RunService").RenderStepped:Connect(function()
        local character = LocalPlayer.Character
        if not Config.WalkOnWater or not character then return end

        local hrp = character:FindFirstChild("HumanoidRootPart")
        if not hrp then return end

        if not waterPlatform or not waterPlatform.Parent then
            waterPlatform = Instance.new("Part")
            waterPlatform.Name = "WaterPlatform"
            waterPlatform.Anchored = true
            waterPlatform.CanCollide = true
            waterPlatform.Transparency = 1
            waterPlatform.Size = Vector3.new(15, 1, 15)
            waterPlatform.Parent = workspace
        end

        local rayParams = RaycastParams.new()
        rayParams.FilterDescendantsInstances = { workspace.Terrain }
        rayParams.FilterType = Enum.RaycastFilterType.Include
        rayParams.IgnoreWater = false

        local rayOrigin = hrp.Position + Vector3.new(0, 5, 0)
        local rayDirection = Vector3.new(0, -500, 0)

        local result = workspace:Raycast(rayOrigin, rayDirection, rayParams)

        if result and result.Material == Enum.Material.Water then
            local waterSurfaceHeight = result.Position.Y
            waterPlatform.Position = Vector3.new(hrp.Position.X, waterSurfaceHeight, hrp.Position.Z)

            if hrp.Position.Y < (waterSurfaceHeight + 2) and hrp.Position.Y > (waterSurfaceHeight - 5) then
                if not UserInputService:IsKeyDown(Enum.KeyCode.Space) then
                    hrp.CFrame = CFrame.new(hrp.Position.X, waterSurfaceHeight + 3.2, hrp.Position.Z)
                end
            end
        else
            waterPlatform.Position = Vector3.new(hrp.Position.X, -500, hrp.Position.Z)
        end
    end)
end

Tab8:Toggle({
    Title = "Walk on Water",
    Default = Config.WalkOnWater,
    Callback = function(Value)
        Config.WalkOnWater = Value
        if Value then
            walkOnWater()
        else
            if Connections.walkOnWaterConnection then
                Connections.walkOnWaterConnection:Disconnect()
                Connections.walkOnWaterConnection = nil
            end
            if waterPlatform then
                waterPlatform:Destroy()
                waterPlatform = nil
            end
        end
    end
})

if Config.WalkOnWater then
    walkOnWater()
end

-- Tambahan Trade (BETA) yang kamu minta
Tab8:Divider()

Tab8:Section({
    Title = "Trade (BETA)",
    Icon = "handshake",
})

local function EnableAutoAcceptTrade()
    if PromptController and PromptController.FirePrompt and Promise then
        local oldFirePrompt = PromptController.FirePrompt
        PromptController.FirePrompt = function(self, promptText, ...)
            
            if Config.AutoAcceptTrade and type(promptText) == "string" and promptText:find("Accept") and promptText:find("from:") then
                return Promise.new(function(resolve)
                    task.wait(2)
                    resolve(true)
                end)
            end
            
            return oldFirePrompt(self, promptText, ...)
        end
    else
        warn("[Noxius] Gagal memuat PromptController/Promise untuk Auto Accept Trade.")
    end
end

local function EnableAutoSendTrade()
    if PromptController and PromptController.FirePrompt and Promise then
        local oldFirePrompt = PromptController.FirePrompt
        PromptController.FirePrompt = function(self, promptText, ...)
            print(promptText)
            if Config.AutoSendTrade and type(promptText) == "string"  and promptText:find("Would you") then
                return Promise.new(function(resolve)
                    task.wait(2)
                    resolve(true)
                end)
            end
            
            return oldFirePrompt(self, promptText, ...)
        end
    else
        warn("[Noxius] Gagal memuat PromptController/Promise untuk Auto Send Trade.")
    end
end

Tab8:Toggle({
    Title = "Auto Accept",
    Default = false,
    Callback = function(Value)
        Config.AutoAcceptTrade = Value
        EnableAutoAcceptTrade()
    end
})

Tab8:Toggle({
    Title = "Auto Confirm Send",
    Default = false,
    Callback = function(Value)
        Config.AutoSendTrade = Value
        EnableAutoSendTrade()
    end
})

Tab8:Divider()

local Tab9 = Window:Tab({
    Title = "Config",
    Icon = "rbxassetid://116263464348976",
})

Tab9:Section({
    Title = "Save for Autoload",
    Icon = "save",
})

-- Fungsi getRootPart persis dari kode kamu
local function getRootPart()
    local character = LocalPlayer.Character
    if not character then return end
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    return rootPart
end

Tab9:Toggle({
    Title = "Save Position",
    Description = "Simpan posisi saat ini untuk autoload",
    Default = Config.savePosition,
    Callback = function(Value)
        Config.savePosition = Value
        if Value then
            local rootPart = getRootPart()
            if rootPart then
                local cf = rootPart.CFrame
                Config.position = string.format(
                    "CFrame.new(%f, %f, %f)",
                    cf.Position.X,
                    cf.Position.Y,
                    cf.Position.Z
                )
                print("Position saved: " .. Config.position)
            else
                print("RootPart tidak ditemukan saat save position")
            end
        end
    end
})

-- Auto load position kalau config true (persis dari kode kamu)
if Config.savePosition then
    print("config position")
    print(Config.position)
    local rootpart = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if rootpart and Config.position and Config.position ~= "" then
        local success, cf = pcall(function()
            return loadstring("return " .. Config.position)()
        end)
        if success and cf then
            print("cf loaded")
            print(cf)
            rootpart.CFrame = cf
        else
            print("Gagal load position dari config")
        end
    end
end

Tab9:Button({
    Title = "Save Config",
    Description = "Simpan semua konfigurasi saat ini",
    Callback = function()
        if Config.savePosition then
            local rootPart = getRootPart()
            if rootPart then
                local cf = rootPart.CFrame
                Config.position = string.format(
                    "CFrame.new(%f, %f, %f)",
                    cf.Position.X,
                    cf.Position.Y,
                    cf.Position.Z
                )
                print("Position updated before save: " .. Config.position)
            end
        end
        SaveAllConfig()
        WindUI:Notify({
            Title = "Config",
            Content = "Semua konfigurasi telah disimpan!",
            Duration = 3
        })
    end
})

Tab9:Divider()
